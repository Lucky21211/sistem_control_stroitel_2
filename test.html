<!-- test.html -->
<!DOCTYPE html>
<html>
<head>
    <title>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API</title>
    <style>
        body { font-family: Arial; margin: 20px; }
        .endpoint { margin: 10px 0; padding: 10px; border: 1px solid #ccc; }
        button { margin: 5px; padding: 8px 15px; }
        pre { background: #f5f5f5; padding: 10px; }
    </style>
</head>
<body>
    <h1>üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤</h1>
    
    <div class="endpoint">
        <h3>1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h3>
        <input type="text" id="regEmail" placeholder="Email" value="test@example.com">
        <input type="password" id="regPassword" placeholder="–ü–∞—Ä–æ–ª—å" value="password123">
        <input type="text" id="regName" placeholder="–ò–º—è" value="Test User">
        <button onclick="register()">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
    </div>

    <div class="endpoint">
        <h3>2. –í—Ö–æ–¥</h3>
        <input type="text" id="loginEmail" placeholder="Email" value="test@example.com">
        <input type="password" id="loginPassword" placeholder="–ü–∞—Ä–æ–ª—å" value="password123">
        <button onclick="login()">–í–æ–π—Ç–∏</button>
    </div>

    <div class="endpoint">
        <h3>3. –ü—Ä–æ—Ñ–∏–ª—å (—Ç—Ä–µ–±—É–µ—Ç —Ç–æ–∫–µ–Ω)</h3>
        <button onclick="getProfile()">–ü–æ–ª—É—á–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</button>
    </div>

    <div class="endpoint">
        <h3>4. –°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑</h3>
        <button onclick="createOrder()">–°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑</button>
    </div>

    <div class="endpoint">
        <h3>5. –°–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤</h3>
        <button onclick="getOrders()">–ü–æ–ª—É—á–∏—Ç—å –∑–∞–∫–∞–∑—ã</button>
    </div>

    <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç:</h3>
    <pre id="result"></pre>

    <script>
        let token = '';
        const API_URL = 'http://localhost:3000';

        function showResult(data) {
            document.getElementById('result').textContent = JSON.stringify(data, null, 2);
        }

        async function register() {
            const email = document.getElementById('regEmail').value;
            const password = document.getElementById('regPassword').value;
            const name = document.getElementById('regName').value;
            
            const response = await fetch(`${API_URL}/v1/auth/register`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ email, password, name })
            });
            showResult(await response.json());
        }

        async function login() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            const response = await fetch(`${API_URL}/v1/auth/login`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ email, password })
            });
            const data = await response.json();
            if (data.success) {
                token = data.data.token;
                alert('–¢–æ–∫–µ–Ω –ø–æ–ª—É—á–µ–Ω!');
            }
            showResult(data);
        }

        async function getProfile() {
            if (!token) return alert('–°–Ω–∞—á–∞–ª–∞ –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É!');
            
            const response = await fetch(`${API_URL}/v1/profile`, {
                headers: { 'Authorization': `Bearer ${token}` }
            });
            showResult(await response.json());
        }

        async function createOrder() {
            if (!token) return alert('–°–Ω–∞—á–∞–ª–∞ –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É!');
            
            const response = await fetch(`${API_URL}/v1/orders`, {
                method: 'POST',
                headers: { 
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${token}`
                },
                body: JSON.stringify({
                    items: [
                        { product: "–ö–∏—Ä–ø–∏—á", quantity: 100, price: 50 },
                        { product: "–¶–µ–º–µ–Ω—Ç", quantity: 10, price: 300 }
                    ],
                    total: 8000
                })
            });
            showResult(await response.json());
        }

        async function getOrders() {
            if (!token) return alert('–°–Ω–∞—á–∞–ª–∞ –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É!');
            
            const response = await fetch(`${API_URL}/v1/orders`, {
                headers: { 'Authorization': `Bearer ${token}` }
            });
            showResult(await response.json());
        }
    </script>
</body>
</html>